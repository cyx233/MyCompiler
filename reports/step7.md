# 实验报告
#### 计81 陈雨翔 2018011295
## 任务概述
1. 改进语法
2. 修改名称解析，使用stacked_dict实现作用域。stacked_dict有两个字典列表，_d保存本作用域中变量,_s保存“开作用域”中变量。进入作用域压栈，离开作用域弹栈。
3. IR实现离开作用域时回收栈空间。
## 遇到的困难
其实之前已经借鉴完成了名称解析的相关部分。本来这一步做的很快，但是出现了离开作用域回收栈空间不正确的情况。研究了很久，最后排查发现是变量名打错了，而python又正好可以在任何位置声明成员变量，没有报错或警告，一直没有发现。令人心情变得很糟糕的一个问题。
## 思考题
### 第一题
```c++
int main() {
    int x = 0;
    if (x) {
        return x;
    } else {
        int x = 2;
    }
    return x;
}
```
### 第二题
某些语言（如C语言）可以在一遍编译，因为比如C中的函数需要在第一次调用之前声明，因此编译器在读取函数调用之前已经得知函数的信息。在更现代的语言中，例如Java、python的类函数，可以在声明之前调用。这样的语言无法在一遍编译，必须要名称解析作为单独的一个阶段在 IR 生成之前执行。
## 代码复用
1. 示例程序中 stacked_dict
   